{#- master snippet for all scheming form fields -#}
{#- render the field the user requested, or use a default field -#}

{% if request.endpoint == 'dataset.new' %}

  {%- set form_snippet = field.form_snippet -%}

  {%- if not form_snippet -%}
    {%- set form_snippet = 'text.html' -%}
  {%- endif -%}

  {%- if '/' not in form_snippet -%}
    {%- set form_snippet = 'scheming/form_snippets/' + form_snippet -%}
  {%- endif -%}

  {%- snippet form_snippet, field=field, data=data, errors=errors,
    licenses=licenses, entity_type=entity_type, object_type=object_type -%}
{% elif request.endpoint == 'dataset.edit' %}
    {% set pkg = h.thai_gdc_get_action('package_show', {'id':data.name}) %}
  
    {%- set form_snippet = field.form_snippet -%}
  
    {%- if not form_snippet -%}
      {%- set form_snippet = 'text.html' -%}
    {%- endif -%}

    {%- if '/' not in form_snippet -%}
      {%- set form_snippet = 'scheming/form_snippets/' + form_snippet -%}
    {%- endif -%}

    {%- snippet form_snippet, field=field, data=data, errors=errors,
      licenses=licenses, entity_type=entity_type, object_type=object_type -%}

{% elif request.endpoint == 'resource.new' or request.endpoint == 'resource.edit'  %}
  {% set pkg = h.thai_gdc_get_action('package_show', {'id':package_name}) %}

  {%- set form_snippet = field.form_snippet -%}

  {%- if not form_snippet -%}
    {%- set form_snippet = 'text.html' -%}
  {%- endif -%}

  {%- if '/' not in form_snippet -%}
    {%- set form_snippet = 'scheming/form_snippets/' + form_snippet -%}
  {%- endif -%}

  {%- snippet form_snippet, field=field, data=data, errors=errors,
    licenses=licenses, entity_type=entity_type, object_type=object_type -%}
{% else %}
  {%- set form_snippet = field.form_snippet -%}

  {%- if not form_snippet -%}
    {%- set form_snippet = 'text.html' -%}
  {%- endif -%}

  {%- if '/' not in form_snippet -%}
    {%- set form_snippet = 'scheming/form_snippets/' + form_snippet -%}
  {%- endif -%}

  {%- snippet form_snippet, field=field, data=data, errors=errors,
    licenses=licenses, entity_type=entity_type, object_type=object_type -%}
{% endif %}

